<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Patient ID record grouping — uk_patient_id • epidm</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Patient ID record grouping — uk_patient_id"><meta name="description" content="
Groups patient records from multiple isolates with a single integer patientID
by grouping patient identifiers.
Grouping is based on the following stages:
matching nhs number and date of birth
Hospital number &amp;amp;  Date of Birth
NHS number &amp;amp; Hospital Number
NHS number &amp;amp; Name
Hospital number &amp;amp; Name
Sex &amp;amp; Date of Birth &amp;amp; Surname
Sex &amp;amp; Date of Birth &amp;amp; Fuzzy Name
Sex &amp;amp; Year and Month of Birth &amp;amp; Fuzzy Name
Postcode &amp;amp; Name
Name Swaps (when first and last name are the wrong way around)


Identifiers are copied over where they are missing or invalid to the grouped
records."><meta property="og:description" content="
Groups patient records from multiple isolates with a single integer patientID
by grouping patient identifiers.
Grouping is based on the following stages:
matching nhs number and date of birth
Hospital number &amp;amp;  Date of Birth
NHS number &amp;amp; Hospital Number
NHS number &amp;amp; Name
Hospital number &amp;amp; Name
Sex &amp;amp; Date of Birth &amp;amp; Surname
Sex &amp;amp; Date of Birth &amp;amp; Fuzzy Name
Sex &amp;amp; Year and Month of Birth &amp;amp; Fuzzy Name
Postcode &amp;amp; Name
Name Swaps (when first and last name are the wrong way around)


Identifiers are copied over where they are missing or invalid to the grouped
records."><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@alexbhatt"><meta name="twitter:site" content="@alexbhatt"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epidm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/alexbhatt/epidm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Patient ID record grouping</h1>
      <small class="dont-index">Source: <a href="https://github.com/alexbhatt/epidm/blob/master/R/patient_id.R" class="external-link"><code>R/patient_id.R</code></a></small>
      <div class="d-none name"><code>uk_patient_id.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Groups patient records from multiple isolates with a single integer patientID
by grouping patient identifiers.</p>
<p>Grouping is based on the following stages:</p><ol><li><p>matching nhs number and date of birth</p></li>
<li><p>Hospital number &amp;  Date of Birth</p></li>
<li><p>NHS number &amp; Hospital Number</p></li>
<li><p>NHS number &amp; Name</p></li>
<li><p>Hospital number &amp; Name</p></li>
<li><p>Sex &amp; Date of Birth &amp; Surname</p></li>
<li><p>Sex &amp; Date of Birth &amp; Fuzzy Name</p></li>
<li><p>Sex &amp; Year and Month of Birth &amp; Fuzzy Name</p></li>
<li><p>Postcode &amp; Name</p></li>
<li><p>Name Swaps (when first and last name are the wrong way around)</p></li>
</ol><p>Identifiers are copied over where they are missing or invalid to the grouped
records.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">uk_patient_id</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nhs_number <span class="op">=</span> <span class="st">"nhs_number"</span>, hospital_number <span class="op">=</span> <span class="st">"patient_hospital_number"</span>,</span>
<span>    date_of_birth <span class="op">=</span> <span class="st">"date_of_birth"</span>, sex_mfu <span class="op">=</span> <span class="st">"sex"</span>, forename <span class="op">=</span> <span class="st">"forename"</span>, surname <span class="op">=</span></span>
<span>    <span class="st">"surname"</span>, postcode <span class="op">=</span> <span class="st">"postcode"</span><span class="op">)</span>,</span>
<span>  .useStages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span>,</span>
<span>  <span class="va">.sortOrder</span>,</span>
<span>  .keepValidNHS <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .forceCopy <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a data.frame or data.table containing the patient data</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>a named list to provide the column names with identifiers, quoted</p><dl><dt><code>nhs_number</code></dt>
<dd><p>the patient NHS number</p></dd>

<dt><code>hospital_number</code></dt>
<dd><p>the patient Hospital numbers also known as the local patient identifier</p></dd>

<dt><code>date_of_birth</code></dt>
<dd><p>the patient date of birth</p></dd>

<dt><code>sex_mfu</code></dt>
<dd><p>the patient sex or gender field as Male/Female/Unknown</p></dd>

<dt><code>forename</code></dt>
<dd><p>the patient forename</p></dd>

<dt><code>surname</code></dt>
<dd><p>the patient surname</p></dd>

<dt><code>postcode</code></dt>
<dd><p>the patient postcode</p></dd>


</dl></dd>


<dt id="arg--usestages">.useStages<a class="anchor" aria-label="anchor" href="#arg--usestages"></a></dt>
<dd><p>optional, default 1:11; set to 1 if you wish patient ID to
be assigned cases with the same DOB and NHS number, set to 2 if you wish patient
ID to be assigned to cases with the same hospital number (HOS) and DOB, set to
3 if you wish patient ID to be assigned cases with the same NHS and HOS number,
set to 4 if you wish patient ID to be assigned cases with the same NHS number
and surname, set to 5 if you wish patient ID to be assigned cases with the same
hospital number and surname, set to 6 if you wish patient ID to be assigned
cases with the same DOB and surname, set to 7 if you wish patient ID to be
assigned cases with the same sex and full name, set to 8 if you wish patient
ID to be assigned cases with the same sex, DOB and fuzzy name, set to 9 if you
wish patient ID to be assigned cases with the same DOB and fuzzy name, set to
10 if you wish patient ID to be assigned cases with the same name and postcode,
set to 11 if you wish patient ID to be assigned cases with the same first name
or second name in changing order and date of birth.</p></dd>


<dt id="arg--sortorder">.sortOrder<a class="anchor" aria-label="anchor" href="#arg--sortorder"></a></dt>
<dd><p>optional; a column as a character to allow a sorting
order on the id generation</p></dd>


<dt id="arg--keepvalidnhs">.keepValidNHS<a class="anchor" aria-label="anchor" href="#arg--keepvalidnhs"></a></dt>
<dd><p>optional, default FALSE; set TRUE if you wish to retain
the column with the NHS checksum result stored as a BOOLEAN</p></dd>


<dt id="arg--forcecopy">.forceCopy<a class="anchor" aria-label="anchor" href="#arg--forcecopy"></a></dt>
<dd><p>optional, default FALSE; TRUE will force data.table to take a copy
instead of editing the data without reference</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe with one new variable:</p><dl><dt><code>id</code></dt>
<dd><p>a unique patient id</p></dd>

<dt><code>valid_nhs</code></dt>
<dd><p>if retained using argument <code>.keepValidNHS=TRUE</code>, a
BOOLEAN containing the result of the NHS checksum validation</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">uk_patient_id</span><span class="op">(</span></span></span>
<span class="r-in"><span> data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">epidm</span><span class="fu">::</span><span class="va"><a href="lab_data.html">lab_data</a></span>,<span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   nhs_number <span class="op">=</span> <span class="st">'nhs_number'</span>,</span></span>
<span class="r-in"><span>   hospital_number <span class="op">=</span> <span class="st">'local_patient_identifier'</span>,</span></span>
<span class="r-in"><span>   date_of_birth <span class="op">=</span> <span class="st">'patient_birth_date'</span>,</span></span>
<span class="r-in"><span>   sex_mfu <span class="op">=</span> <span class="st">'sex'</span>,</span></span>
<span class="r-in"><span>   forename <span class="op">=</span> <span class="st">'forename'</span>,</span></span>
<span class="r-in"><span>   surname <span class="op">=</span> <span class="st">'surname'</span></span></span>
<span class="r-in"><span> <span class="op">)</span>,</span></span>
<span class="r-in"><span> .sortOrder <span class="op">=</span> <span class="st">'specimen_date'</span>,</span></span>
<span class="r-in"><span> .forceCopy <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">[</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          id nhs_number local_patient_identifier patient_birth_date    sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;int&gt;     &lt;char&gt;                   &lt;char&gt;             &lt;Date&gt; &lt;char&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:     1  852542115                  AY45405         1952-03-31      F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:     2  636618808                  AN80559         1974-10-16      F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:     3  676931293                  BE25621         1984-11-12      F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:     4  150995260                  JY96040         1949-05-13      M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:     5  656066785                   CK3584         1944-02-03      F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  996:   996  831527085                  HZ50426         1934-06-18      F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  997:   997  470415263                  AX81005         1971-08-06      F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  998:   998  581923601                  QZ18729         1964-02-14      M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  999:   999  982821706                  HD14018         1969-02-22      F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1000:  1000  541747444                  EI64224         1989-02-14      F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         surname forename  organism_species_name specimen_date specimen_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;char&gt;   &lt;char&gt;                 &lt;char&gt;        &lt;Date&gt;        &lt;fctr&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:   CHITTUM  DARLENE PSEUDOMONAS AERUGINOSA    2020-01-14  URINE/KIDNEY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:  AL-GHANI    CALIE  STAPHYLOCOCCUS AUREUS    2020-01-14  URINE/KIDNEY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:     MYERS    DEBRA  KLEBSIELLA PNEUMONIAE    2020-01-14         BLOOD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:   BLEVANS    DANTE PSEUDOMONAS AERUGINOSA    2020-01-17         BLOOD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:   GROOVER  NAJEEMA  KLEBSIELLA PNEUMONIAE    2020-02-01         BLOOD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  996:     BEALS    JAYLA  STAPHYLOCOCCUS AUREUS    2023-12-24         BLOOD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  997:  CASTILLO  YOLANDA  KLEBSIELLA PNEUMONIAE    2023-12-25         BLOOD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  998: EL-HALABY    RAJAA  STAPHYLOCOCCUS AUREUS    2023-12-26  URINE/KIDNEY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  999:   THURMAN      MAY PSEUDOMONAS AERUGINOSA    2023-12-27  URINE/KIDNEY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1000:  KILSTROM     KALI  KLEBSIELLA PNEUMONIAE    2023-12-29         BLOOD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       lab_code local_authority_name local_authority_code</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;char&gt;               &lt;char&gt;               &lt;char&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:  ZJ60076              Enfield            E09000010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:  VJ49160              Salford            E08000006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:  ID41899        South Norfolk            E07000149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:  JH70033           Spelthorne            E07000213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:  PH46212            Sheffield            E08000019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  996:  WI90375       South Lakeland            E07000031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  997:   CW7915           Manchester            E08000003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  998:  VJ49160                Wigan            E08000010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  999:  YK19355            Redbridge            E09000026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1000:  GF74315       South Somerset            E07000189</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Bhattacharya, Alice Graham, Harshana Liyanage.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

